import os

import pytest

from aug.data.fastq import *


class TestFileOps:
    def test_iter(self, base_data_path):
        path = os.path.join(base_data_path, "test.fastq")
        actual = str(list(fastq_file_iter(path)))
        expect = "[FastqRecord(id=SRR1363257.37 GWZHISEQ01:153:C1W31ACXX:5:1101:14027:2198 length=101, seq=GGTTGCAGATTCGCAGTGTCGCTGTTCCAGCGCATCACATCTTTGATGTTCACGCCGTGGCGTTTAGCAATGCTTGAAAGCGAATCGCCTTTGCCCACACG, quality_str=@?:=:;DBFADH;CAECEE@@E:FFHGAE4?C?DE<BFGEC>?>FHE4BFFIIFHIBABEECA83;>>@>@CCCDC9@@CC08<@?@BB@9:CC#######), FastqRecord(id=SRR1363257.46 GWZHISEQ01:153:C1W31ACXX:5:1101:19721:2155 length=101, seq=GTATGAGGTTTTGCTGCATTCTCTGNGCGAATATTAACTCCNTNNNNNTTATAGTTCAAAGCAAGTACCTGTCTCTTATACACATCTCCGAGCCCACGAGC, quality_str=@@<?=D?D==?<AFGDF+AIHEACH#22<:?E8??:9??GG#0#####000;CF=C)4.==CA@@@)=7?C7?E37;3@>;;(.;>AB#############), FastqRecord(id=SRR1363257.77 GWZHISEQ01:153:C1W31ACXX:5:1101:5069:2307 length=101, seq=GCTTCTCTTAACTGAGGTCACCATCATGCCGTTAAGTCCCTACCTCTCTTTTGCCGGTAACTGTTCCGCCGCGATTGCCTTTTATCTGTCTCTTATACACC, quality_str=??<DBD;4C2=<BB>:AC;<CF<CE@FE9@E1C@891CD*9:?:3D@DD4?D<DD:0;@A=AEIDDA##################################)]"
        assert actual == expect
